if (!arguments) {
    return;
}
if (typeof arguments[0] !== 'function') {
    return;
}
var loadargs = arguments;
var role = loadargs[2] ? +loadargs[2] : 1;
var status_code = 200;
var host = [];
var hostindex = 0;
var hostmax = 0;
var tsv = [
'//fe-static.vipkidteachers.com',
'//fe-static-ayk.vipkidteachers.com',
'//fe-static.vipkid.com.cn',
'//fe-static-ali.vipkid.com.cn'
];
var ssv = [
'//fe-static.vipkid.com.cn',
'//fe-static-ali.vipkid.com.cn',
'//fe-static.vipkidteachers.com',
'//fe-static-ayk.vipkidteachers.com',
]
var assetspath = '/ic-sdk/v1/static/';

if (role === 1) {
  host = tsv;
} else {
  host = ssv;
}

hostmax = host.length - 1;

function isReady(node) {
  return node.readyState === 'complete' || node.readyState === 'loaded';
}
function loadJs(url, setting, scb, fcb) {
  var node = document.createElement('script');
  node.setAttribute('class', 'icsdk-js');
  node.onload = scb;
  node.onerror = fcb;
  node.src = host[hostindex] + assetspath + url;
  document.body.appendChild(node);
}
function loadItem(url, list, setting, callback) {
  loadJs(url, setting, finishloading, failloading);
  function finishloading() {
    var urlIndex = list.indexOf(url);
    if (urlIndex > -1) {
      list.splice(urlIndex, 1);
    }
    if (list.length === 0) {
      function destroy() {
        var nodelist = document.querySelectorAll('.icsdk-js');
        for(var max = nodelist.length; max--;) {
          document.body.removeChild(nodelist[max]);
        }
        window.__ic_sdk && window.__ic_sdk.des();
      }
      window.__ic_sdk.destroy = destroy;
      callback(window.__ic_sdk, status_code);
    }
  }
  function failloading(e) {
    if (hostindex < hostmax) {
      hostindex = hostindex + 1;
    } else {
      hostindex = 0;
      status_code = 500;
      callback({}, status_code);
      return ;
    }
    loadJs(url, setting, finishloading, failloading);
  }
}
function doInit(list, setting, callback) {
  var cb = function(res, status_code) {
    callback && callback(res, status_code);
  };

  list = Array.prototype.slice.call(list || []);

  if (list.length === 0) {
    cb({
      status: 0,
      msg: 'list empty'
    });
    return;
  }

  for (var i = 0, len = list.length; i < len; i++) {
    loadItem(list[i], list, setting, cb);
  }
}
function ready(node, callback) {
  if (isReady(node)) {
      callback();
  } else {
    // 1500ms 以后，直接开始下载资源文件，不再等待load事件
    var timeLeft = 1500;
    var isExecute = false;
    window.addEventListener('load', function() {
      if (!isExecute) {
          callback();
          isExecute = true;
      }
    });

    setTimeout(function() {
      if (!isExecute) {
          callback();
          isExecute = true;
      }
    }, timeLeft);
  }
}
/**
* vkLoader
*/
var vkLoader = {
  sync: function(list, callback) {
    ready(document, function() {
      doInit(list, {
          sync: true
      }, callback);
    });
  }
}
/**
* 执行
*/
var loadstring = 'index.a6efad91fedd82336e80.js,';
var loadarray = loadstring.slice(0, -1).split(',');
vkLoader.sync(loadarray, function(sdk, status) {
  loadargs[0](sdk, status);
});