<!DOCTYPE html><html lang="en" data-reactroot=""><head><title data-react-helmet="true">å¼€å‘ç¬”è®°</title><meta data-react-helmet="true" name="title" content="å¼€å‘ç¬”è®°"/><meta data-react-helmet="true" property="og:description" content="Javascriptæ€»æ˜¯åœ¨å‘å¸ƒæ–°åŠŸèƒ½ï¼Œæƒ³è¦ä¸€ç›´è·Ÿä¸Šè„šæ­¥ä¸å¤ªå®¹æ˜“ï¼Œé…å¥—çš„demoä¹Ÿå¾ˆå°‘ï¼Œæœ¬æ–‡æ—¨åœ¨ç»“åˆå®ä¾‹å±•ç¤ºæœ€æ–°çš„18ä¸ªæ–°ç‰¹æ€§ï¼Œåšä¸ªæŠ€æœ¯çš„å¸ƒé“è€…ã€‚

ä¸‹é¢ä¾ç…§ç‰ˆæœ¬çš„å…ˆåé¡ºåºå¼€å§‹ä»‹..."/><meta data-react-helmet="true" property="og:title" content="ES2016, 2017å’Œ2018åˆ°åº•æœ‰å“ªäº›æ–°ä¸œè¥¿ï¼Ÿ"/><meta data-react-helmet="true" property="og:type" content="article"/><meta data-react-helmet="true" name="description" content="Javascriptæ€»æ˜¯åœ¨å‘å¸ƒæ–°åŠŸèƒ½ï¼Œæƒ³è¦ä¸€ç›´è·Ÿä¸Šè„šæ­¥ä¸å¤ªå®¹æ˜“ï¼Œé…å¥—çš„demoä¹Ÿå¾ˆå°‘ï¼Œæœ¬æ–‡æ—¨åœ¨ç»“åˆå®ä¾‹å±•ç¤ºæœ€æ–°çš„18ä¸ªæ–°ç‰¹æ€§ï¼Œåšä¸ªæŠ€æœ¯çš„å¸ƒé“è€…ã€‚

ä¸‹é¢ä¾ç…§ç‰ˆæœ¬çš„å…ˆåé¡ºåºå¼€å§‹ä»‹..."/><meta data-react-helmet="true" name="keywords" content="js,JavaScript,å‰ç«¯,frontend,ECMAScript,ECMAScript 2016,ECMAScript 2017,ECMAScript 2018,es6,es7,async,await,async/await"/><link rel="preload" as="script" href="https://shjie047.github.io/bootstrap.9d1d5f8f.js"/><link rel="preload" as="script" href="https://shjie047.github.io/templates/src/containers/Post.f97300b9.js"/><link rel="preload" as="script" href="https://shjie047.github.io/main.96794c51.js"/><link rel="preload" as="style" href="https://shjie047.github.io/styles.49ed94a1.css"/><link rel="stylesheet" href="https://shjie047.github.io/styles.49ed94a1.css"/><meta charSet="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><style data-styled-components="bDWFJH gkZsHu fuJRCL mvmj eesrXV gRptws">
/* sc-component-id: sc-bwzfXH */
.fuJRCL{padding:0 40px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;} @media only screen and (max-width:400px){.fuJRCL{padding:0 20px;}} .fuJRCL a{font-size:1.6rem;font-weight:normal;} .fuJRCL .icon-link{font-size:1.8rem;} .fuJRCL .archive{margin-left:auto;}
/* sc-component-id: sc-htpNat */
@media only screen and (max-width:920px){.mvmj{display:none;}} .mvmj a{font-size:1.4rem;} .mvmj::before{content:'';height:2.1rem;width:1px;background-color:#00000038;display:inline-block;vertical-align:middle;}
/* sc-component-id: sc-bxivhb */
.eesrXV{display:none;padding:0;margin:0;position:relative;font-size:1.4rem;} .eesrXV::before{content:'';height:2.1rem;width:1px;background-color:#00000038;display:inline-block;vertical-align:middle;} .eesrXV > i{display:inline-block;padding:1rem;color:#fff;font-weight:normal;-webkit-transition:color .3s ease;transition:color .3s ease;} .eesrXV a{font-size:1.4rem;font-weight:normal;line-height:1;display:block;padding:1.2rem 3rem 1.2rem 1rem;} .eesrXV li{margin:0;} .eesrXV ul{list-style:none;padding:0;margin:0;position:absolute;top:100%;left:0;background-color:#108db8;display:none;width:120px;padding:10px 0;} .eesrXV ul.show{display:inline-block;} @media only screen and (max-width:920px){.eesrXV{display:inline;}}
/* sc-component-id: sc-ifAKCX */
.gkZsHu{position:absolute;top:0;left:50%;top:50%;font-size:1.6rem;color:#fff;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%);font-weight:normal;cursor:pointer;} .gkZsHu:hover{color:#fff!important;}
/* sc-component-id: sc-dnqmqq */
.gRptws{position:relative;width:80%;max-width:710px;margin:4rem auto;padding-bottom:4rem;border-bottom:1px solid #ebf2f6;word-wrap:break-word;} .gRptws::after{display:block;content:"";width:7px;height:7px;border:1px solid #e7eef2;position:absolute;bottom:-5px;left:50%;margin-left:-5px;background:#fff;border-radius:100%;box-shadow:0 0 0 5px #fff;} .gRptws .read-more{-webkit-text-decoration:none;text-decoration:none;} .gRptws .author-thumb{width:24px;height:24px;float:left;margin-right:9px;border-radius:100%;} .gRptws .post-header{margin-bottom:3.4rem;} .gRptws .post-title a{-webkit-text-decoration:none;text-decoration:none;} .gRptws .post-meta{display:block;margin:1.75rem 0 0;font-family:Open Sans,sans-serif;font-size:1.5rem;line-height:2.2rem;color:#9eabb3;} .gRptws .post-excerpt p{margin:0;font-size:.9em;line-height:1.7em;} .gRptws .post-meta a{color:#9eabb3;-webkit-text-decoration:none;text-decoration:none;} .gRptws .post-meta a:hover{color:#9eabb3;-webkit-text-decoration:underline;text-decoration:underline;} .gRptws .post-date{display:inline-block;text-transform:uppercase;font-size:1.3rem;white-space:nowrap;} .gRptws .post-date.has-author{margin-left:8px;padding-left:12px;border-left:1px solid #d5dbde;} @media only screen and (max-width:900px){.gRptws{font-size:.95em;}} @media only screen and (max-width:500px){.gRptws{width:auto;margin:2rem 16px;padding-bottom:2rem;line-height:1.65em;}.gRptws .post-excerpt p{font-size:.85em;}.gRptws .post-meta{font-size:1.3rem;margin-top:1rem;}} .gRptws pre{padding:1.2rem;} .gRptws pre > code{box-shadow:0 0 15px rgba(0,0,0,.35);padding:1.5rem;}</style></head><body><div id="root"><div class="sc-bdVaJa bDWFJH" data-reactroot=""><div class="headroom-wrapper"><div style="position:relative;top:0;left:0;right:0;z-index:1;-webkit-transform:translateY(0);-ms-transform:translateY(0);transform:translateY(0)" class="headroom headroom--unfixed"><a class="sc-ifAKCX gkZsHu" aria-current="false" href="https://shjie047.github.io/">å¼€å‘ç¬”è®°</a><nav class="sc-bwzfXH fuJRCL"><a class="icon-link" aria-current="false" href="https://shjie047.github.io/"><i class="iconfont icon-home"></i></a><span class="sc-htpNat mvmj"><a aria-current="false" href="https://shjie047.github.io/tags/frontend">å‰ç«¯</a><a aria-current="false" href="https://shjie047.github.io/tags/backend">åç«¯</a><a aria-current="false" href="https://shjie047.github.io/tags/mobile">ç§»åŠ¨ç«¯</a><a aria-current="false" href="https://shjie047.github.io/tags/java">Java</a></span><span class="toggled-popular sc-bxivhb eesrXV"><i class="iconfont icon-popular"></i><ul><li><a aria-current="false" href="https://shjie047.github.io/tags/backend">åç«¯</a></li><li><a aria-current="false" href="https://shjie047.github.io/tags/mobile">ç§»åŠ¨ç«¯</a></li><li><a aria-current="false" href="https://shjie047.github.io/tags/java">Java</a></li></ul></span><a class="archive icon-link" aria-current="false" data-tip="å½’æ¡£" href="https://shjie047.github.io/archives"><i class="iconfont icon-archive"></i></a></nav></div></div><div class="content"><article class="sc-dnqmqq gRptws"><header class="post-header"><h1 class="post-title">ES2016, 2017å’Œ2018åˆ°åº•æœ‰å“ªäº›æ–°ä¸œè¥¿ï¼Ÿ</h1><section class="post-meta "><a aria-current="false" href="https://shjie047.github.io/authors/rajaraodv">rajaraodv</a><time class="post-date has-author" dateTime="2018-04-03">2018/4/3</time><span>, </span><span><span><a aria-current="false" href="https://shjie047.github.io/tags/js">js</a><span>, </span></span><span><a aria-current="false" href="https://shjie047.github.io/tags/javascript">JavaScript</a><span>, </span></span><span><a aria-current="false" href="https://shjie047.github.io/tags/å‰ç«¯">å‰ç«¯</a><span>, </span></span><span><a aria-current="false" href="https://shjie047.github.io/tags/frontend">frontend</a><span>, </span></span><span><a aria-current="false" href="https://shjie047.github.io/tags/ecmascript">ECMAScript</a><span>, </span></span><span><a aria-current="false" href="https://shjie047.github.io/tags/ecmascript 2016">ECMAScript 2016</a><span>, </span></span><span><a aria-current="false" href="https://shjie047.github.io/tags/ecmascript 2017">ECMAScript 2017</a><span>, </span></span><span><a aria-current="false" href="https://shjie047.github.io/tags/ecmascript 2018">ECMAScript 2018</a><span>, </span></span><span><a aria-current="false" href="https://shjie047.github.io/tags/es6">es6</a><span>, </span></span><span><a aria-current="false" href="https://shjie047.github.io/tags/es7">es7</a><span>, </span></span><span><a aria-current="false" href="https://shjie047.github.io/tags/async">async</a><span>, </span></span><span><a aria-current="false" href="https://shjie047.github.io/tags/await">await</a><span>, </span></span><span><a aria-current="false" href="https://shjie047.github.io/tags/async/await">async/await</a></span></span></section></header><section class="post-content markdown-body"><div><p><img style="display:block;margin:0 auto;margin-top:4rem;cursor:zoom-in" src="http://p6jqy6mfr.bkt.clouddn.com/1_Z-9unq6Am3vekNOa5fD1xg.png"/></p><p>Javascriptæ€»æ˜¯åœ¨å‘å¸ƒæ–°åŠŸèƒ½ï¼Œæƒ³è¦ä¸€ç›´è·Ÿä¸Šè„šæ­¥ä¸å¤ªå®¹æ˜“ï¼Œé…å¥—çš„demoä¹Ÿå¾ˆå°‘ï¼Œæœ¬æ–‡æ—¨åœ¨ç»“åˆå®ä¾‹å±•ç¤ºæœ€æ–°çš„18ä¸ªæ–°ç‰¹æ€§ï¼Œåšä¸ªæŠ€æœ¯çš„å¸ƒé“è€…ã€‚</p><p><strong>ä¸‹é¢ä¾ç…§ç‰ˆæœ¬çš„å…ˆåé¡ºåºå¼€å§‹ä»‹ç»:</strong></p><p><img style="display:block;margin:0 auto;margin-top:4rem;cursor:zoom-in" src="http://p6jqy6mfr.bkt.clouddn.com/1_K09EWrqTcTwN9_dlhlzy6Q.png"/></p><h2>1. Array.prototype.includes</h2><p>é¦–å…ˆæ˜¯æ•°ç»„çš„ä¸€ä¸ªå®ä¾‹æ–¹æ³•<code>includes</code>ï¼Œè¿™ä¸ªæ–¹æ³•çš„åŠŸèƒ½å¾ˆç®€å•ï¼šç”¨äºåˆ¤æ–­æŸä¸€é¡¹æ˜¯å¦åœ¨æ•°ç»„é‡Œï¼Œå’Œè¿™ä¸ªæ–¹æ³•åŠŸèƒ½ç±»ä¼¼çš„æœ‰<code>indexOf</code>ï¼Œä¸¤è€…çš„åŒºåˆ«æ˜¯<code>indexOf</code>æ— æ³•åˆ¤æ–­<code>NaN</code>ï¼Œ
å¦‚å›¾ï¼š</p><pre><code class="language-Javascript">const arr = [1, 2, 3, 4, NaN];

// es5
if (arr.indexOf(3) &gt;= 0) {
  console.log(true)
}

// es2016
if (arr.includes(e)) {
  console.log(true)
}

// æ³¨ï¼šindexOfä¸æ”¯æŒæ£€æŸ¥`NaN`
arr.indexOf(NaN) // -1
arr.includes(NaN) // true</code></pre><h2>2. æ±‚å¹‚è¿ç®—ç¬¦</h2><p>ç¬¬äºŒä¸ªæ–°åŠŸèƒ½ä¹Ÿæ¯”è¾ƒç®€å•ï¼š<strong>æ±‚å¹‚è¿ç®—ç¬¦</strong> -- <code>**</code>ï¼Œç”¨äºå–ä»£ä¹‹å‰çš„æ±‚å¹‚æ–¹æ³•<code>Math.pow</code>ï¼Œ
å¦‚å›¾ï¼š</p><pre><code class="language-Javascript">// ä¹‹å‰
Math.pow(3, 2) // 9

// ç°åœ¨
3**2 // 9</code></pre><p><img style="display:block;margin:0 auto;margin-top:4rem;cursor:zoom-in" src="http://p6jqy6mfr.bkt.clouddn.com/1_fV_95TaY3ocgE8hlDhhv8w.png"/></p><h2>1. Object.values()</h2><p><code>Object.values</code>è¿™ä¸ªæ–¹æ³•å’Œ<code>Object.keys</code>ç±»ä¼¼ï¼Œéƒ½æ˜¯è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œé€šè¿‡æ–¹æ³•åå¯ä»¥ç›´è§‚çš„çŒœåˆ°è¿”å›çš„æ˜¯å¯¹è±¡çš„å€¼(value)ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼šä¸¤ä¸ªæ–¹æ³•éƒ½æ˜¯è¿”å›è‡ªèº«åŸå‹çš„å±æ€§ï¼Œä¸åŒ…æ‹¬åŸå‹é“¾ä¸Šçš„å±æ€§ï¼Œå¦‚å›¾ï¼š</p><pre><code class="language-Javascript">const cars = {BMW: 3, Tesla: 2, Toyota: 1}

// es5
const vals = Object.keys(cars).map(key =&gt; cars[key]) 
console.log(vals) // [3, 2, 1]

// es2016
const values = Object.values(cars)
console.log(values) // [3, 2, 1]</code></pre><h2>2. Object.entries()</h2><p><code>Object.entries()</code>è¿™ä¸ªæ–¹æ³•æ¯”è¾ƒæœ‰æ„æ€ï¼Œæœ‰ç‚¹åƒ<code>Object.keys</code>å’Œ<code>Object.values</code>çš„ç»“åˆä½“ï¼ŒåŒæ—¶è¿”å›å¯¹è±¡çš„<code>key</code>å’Œ<code>value</code>ï¼Œå¹¶å°è£…åœ¨ä¸€ä¸ªæ•°ç»„é‡Œï¼Œè¿™ä¸ªæ–¹æ³•çš„å¥½å¤„åœ¨äºä½ å¯ä»¥é€šè¿‡<code>for of</code>éå†ä¸€æ¬¡å–å‡ºkey/value æˆ–è€… æŠŠ<code>Object</code>è½¬ä¸º<code>Map</code>ï¼š</p><p><strong>ä¾‹1</strong>ï¼Œéå†:</p><pre><code class="language-Javascript">const cars = { BMW: 3, Tesla: 2, Toyota: 1 }

// es5çš„éå†æ–¹å¼
// éœ€è¦æŠŠ`key`å–å‡ºæ¥ï¼Œå†éå†
Object.keys(cars).forEach(key =&gt; {
  console.log(`key: ${key}, value: ${cars[key]}`)
})

// es2017
for (let [key, value] of Object.entries(cars)) {
  console.log(`key: ${key}, value: ${cars[key]}`)
}</code></pre><p><strong>ä¾‹2</strong>ï¼ŒæŠŠobjectç›´æ¥è½¬æ¢ä¸º<code>Map</code>:</p><pre><code class="language-Javascript">const cars = { BMW: 3, Tesla: 2, Toyota: 1 }

// es5
const map1 = new Map()
Object.keys(cars).map(key =&gt; {
  map1.set(key, cars[key])
})

console.log(map1) // Map { &#x27;BMW&#x27;: 3, &#x27;Tesla&#x27;: 2, &#x27;Toyota&#x27;: 1 }

// es2016
const map2 = new Map(Object.entries(cars))

console.log(map2) // Map { &#x27;BMW&#x27;: 3, &#x27;Tesla&#x27;: 2, &#x27;Toyota&#x27;: 1 }</code></pre><h2>3. String padding</h2><p>Stringå¢åŠ äº†ä¸¤ä¸ªå®ä¾‹æ–¹æ³• -- <code>padStart</code>å’Œ<code>padEnd</code>ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•å¯ä»¥åœ¨å­—ç¬¦ä¸²çš„é¦–/å°¾æ·»åŠ å…¶ä»–å­—ç¬¦ä¸²:</p><pre><code class="language-Javascript">// &#x27;someStr&#x27;.padStart(å­—ç¬¦æ•°, [,æ·»åŠ çš„å­—ç¬¦])

&#x27;hello&#x27;.padStart(&#x27;10&#x27;, &#x27;a&#x27;) // &#x27;aaaaahello&#x27;, æ·»åŠ äº†5ä¸ªå­—ç¬¦`a`åä¸€å…±`10`ä¸ªå­—ç¬¦
&#x27;hello&#x27;.padEnd(&#x27;10&#x27;, &#x27;b&#x27;) // &#x27;hellobbbbb&#x27;
&#x27;hello&#x27;.padStart(&#x27;7&#x27;) // &#x27;  hello&#x27;, åœ¨å¤´éƒ¨æ·»åŠ ä¸¤ä¸ªä¸ªç©ºæ ¼</code></pre><h3>3.1 padStartç¤ºä¾‹</h3><pre><code class="language-Javascript">const formatted = [0, 1, 12, 123, 1234, 12345].map(num =&gt;
  num.toString().padStart(10, &#x27;0&#x27;)
)

console.log(formatted)
// è¾“å‡º:
// [
//   &#x27;0000000000&#x27;,
//   &#x27;0000000001&#x27;,
//   &#x27;0000000012,&#x27;
//   &#x27;0000000234,&#x27;
//   &#x27;0000001234,&#x27;
//   &#x27;0009012345&#x27;
// ]</code></pre><h3>3.2 padEndç¤ºä¾‹</h3><pre><code class="language-Javascript">const cars = {
  &#x27;ğŸš™BMW&#x27;: &#x27;10&#x27;,
  &#x27;ğŸš˜Tesla&#x27;: &#x27;5&#x27;,
  &#x27;ğŸš–Lamborghini&#x27;: &#x27;0&#x27;
}

Object.entries(cars).map(([name, count]) =&gt; {
  console.log(`${name.padEnd(20, &#x27; -&#x27;)} Count: ${count.padStart(3, &#x27;0&#x27;)}`)
});

//è¾“å‡º:
// ğŸš™BMW - - - - - - -  Count: 010
// ğŸš˜Tesla - - - - - -  Count: 005
// ğŸš–Lamborghini - - -  Count: 000</code></pre><h2>4.Object.getOwnPropertyDescriptors</h2><p>è¿™ä¸ªæ–¹æ³•çš„ä½œç”¨æ˜¯è¡¥å……<code>Object.assign</code>çš„åŠŸèƒ½ï¼Œåœ¨æµ…æ‹·è´(shallow clone)å¯¹è±¡çš„åŸºç¡€ä¸Šï¼Œä¹Ÿä¼šå¤åˆ¶<code>getter</code>å’Œ<code>setter</code>æ–¹æ³•ï¼š</p><p>ä¸‹é¢çš„ä¾‹å­ç”¨<code>Object.defineProperties</code>æ‹·è´åŸå¯¹è±¡<code>Car</code>åˆ°æ–°å¯¹è±¡<code>ElectricCar</code>æ¥åŒºåˆ†<code>Object.assign</code>å’Œ<code>Object.getOwnPropertyDescriptors</code>ã€‚</p><pre><code class="language-Javascript">const Car = {
  name: &#x27;BMW&#x27;,
  price: 100000,
  set discount(x) {
    this.d = x
  }
  get discount() {
    return this.d
  }
}

console.log(Object.getOwnPropertyDescriptor(Car, &#x27;discount&#x27;)
// è¾“å‡º:
// {
//   get: [Function: get],
//   set: [Function: set],
//   enumerable: true,
//   configurable: true
// }

const ElectricCar = Object.assign({}, Car)
console.log(Object.getOwnPropertyDescriptor(ElectricCar, &#x27;discount&#x27;))
// è¾“å‡º:
// {
//   value: undefined,
//   writable: true,
//   enumerable: true,
//   configurable: true
// }

// ä½¿ç”¨`Object.assign`åˆ›å»º`ElectricCar`åï¼Œå±æ€§`getter`å’Œ`setter`ä¸¢å¤±äº†</code></pre><h3>ä½¿ç”¨<code>Object.getOwnPropertyDescriptors</code>å:</h3><pre><code class="language-Javascript">const Car = {
  name: &#x27;BMW&#x27;,
  price: 100000,
  set discount(x) {
    this.d = x
  }
  get discount() {
    return this.d
  }
}

const ElectricCar2 = Object.defineProperties({}, Object.getOwnPropertyDescriptors(Car))
// è¾“å‡º:
// {
//   get: [Function: get],  &lt;-----ğŸ‘ˆ
//   set: [Function: set],  &lt;-----ğŸ‘ˆ
//   enumerable: true,
//   configurable: true 
// }</code></pre><h2>5. åœ¨å‡½æ•°æœ€åä¸€ä¸ªå‚æ•°çš„æœ«å°¾æ·»åŠ é€—å·</h2><p>è¿™æ˜¯ä¸ªå¾ˆå°çš„ä¸€ä¸ªåŠŸèƒ½ç‚¹ï¼Œåœ¨å‡½æ•°å½¢å‚æœ€åä¸€ä¸ªå‚æ•°æœ«å°¾æ·»åŠ é€—å·ï¼Œå¯ä»¥é¿å…<code>git blame</code>æç¤ºä¸å¿…è¦çš„æ”¹åŠ¨ï¼Œ
ä»£ç ç¤ºä¾‹ï¼š</p><pre><code class="language-Javascript">// å‡è®¾è¿™ä¸ªå‡½æ•°ç”± `ç¨‹åºå‘˜_1` åˆ›å»º
// è¿™ä¸ªå‡½æ•°æœ€åä¸€ä¸ªå‚æ•°`age`åæ²¡æœ‰é€—å·
function Person(
  name,
  age
) {
  this.name = name
  this.age = age
}

// å¦‚æœ `ç¨‹åºå‘˜_2` è¿™æ—¶æœ‰äº†ä»¥ä¸‹ä¿®æ”¹
function Person(
  name,
  age, /* é‚£ä¹ˆè¿™ä¸ª`,`é€—å·ä¹Ÿä¼šå¼•èµ·`git blame`è®¤ä¸º `ç¨‹åºå‘˜_1` ä¿®æ”¹äº†è¿™ä¸€è¡Œ*/
  gender /* æ·»åŠ äº†æ–°å‚æ•° */
) { // æ–°æ·»åŠ 
  this.name = name
  this.age = age
  this.gender = gender // æ–°æ·»åŠ 
}

// es2017å¯¹è¿™ä¸ªæ··æ·†çš„å¤„ç†åŠæ³•æ˜¯:
// é€šè¿‡ `ç¨‹åºå‘˜_1`åœ¨`age`æœ«å°¾æ·»åŠ `,`é€—å·

// æ›´æ–°å¦‚ä¸‹:

// å‡è®¾è¿™ä¸ªå‡½æ•°ç”± `ç¨‹åºå‘˜_1` åˆ›å»º
// åœ¨æœ€åä¸€ä¸ªå‚æ•°`age`åæ·»åŠ `,`é€—å·
function Person(
  name,
  age, /* æ·»åŠ é€—å· */
) {
  this.name = name
  this.age = age
}</code></pre><h2>6. Async/Await</h2><p>è¿™ä¸ªç‰¹æ€§æ˜¯ç›®å‰ä¸ºæ­¢æœ€é‡è¦çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œä½¿ç”¨<code>async</code>å‡½æ•°å¯ä»¥è®©æˆ‘ä»¬é¿å…é¢‘ç¹è°ƒç”¨<em>æ¶å¿ƒçš„</em><code>callback</code>ï¼Œä½¿ä»£ç ä¿æŒå¹²å‡€æ•´æ´ã€‚</p><p>å½“ç¼–è¯‘å™¨è¿›å…¥<code>async</code>å‡½æ•°åï¼Œé‡åˆ°<code>await</code>å…³é”®å­—ä¼šæš‚åœæ‰§è¡Œï¼Œå¯ä»¥æŠŠ<code>await</code>åçš„è¡¨è¾¾å¼çœ‹æˆä¸€ä¸ª<code>promise</code>ï¼Œç›´åˆ°promiseè¢«<code>resolve</code>æˆ–<code>reject</code>åï¼Œå‡½æ•°æ‰ä¼šæ¢å¤æ‰§è¡Œï¼Œ
å…·ä½“çœ‹å¦‚ä¸‹ä»£ç ï¼š</p><pre><code class="language-Javascript">  
// es5çš„`Promise`
function getAmount(userId) {
  getUser(userId)
    .then(getBankBalance)
    .then(amount =&gt; {
      console.log(amount)
    })
}

// es2017çš„`async`
async function getAmount2(userId) {
  var user = await getUser(userId)
  var amount = await getBankBalance()
  console.log(amount)
}

getAmount(&#x27;1&#x27;) // $1,000
getAmount2(&#x27;1&#x27;) // $1,000

function getUser(userId) {
  return new Promise(resolve =&gt; {
    setTimeout(() =&gt; {
      resolve(&#x27;å¼ ä¸‰&#x27;)
    }, 1000)
  })
}

function getBankBalance() {
  return new Promise((resolve, reject) =&gt; {
    setTimeout(() =&gt; {
      if (user === &#x27;å¼ ä¸‰&#x27;) {
        resolve(&#x27;$1,000&#x27;)
      } else {
        resolve(&#x27;Unknown User&#x27;)
      }
    }, 1000)
  })
}</code></pre><h3>6.1 Asyncå‡½æ•°æœ¬èº«è¿”å›ä¸€ä¸ªPromise</h3><p>è¦æƒ³å¾—åˆ°Asyncå‡½æ•°çš„è¿”å›å€¼ï¼Œéœ€è¦æŠŠè¿”å›å€¼å½“ä½œä¸€ä¸ªpromiseè¿›è¡Œ<code>then</code>æ±‚å€¼ã€‚</p><p>å…·ä½“çœ‹å¦‚ä¸‹ä»£ç ï¼š</p><pre><code class="language-Javascript">async function doubleAndAdd(a, b) {
  a = await doubleAfter1Sec(a)
  b = await doubleAfter1Sec(b)
  return a + b
}

doubleAndAdd(1, 2).then(console.log) // 5 

async function doubleAfter1Sec(param) {
  return new Promise(resolve =&gt; {
    setTimeout(() =&gt; {
      resolve(param * 2)
    }, 1000)
  })
}</code></pre><h3>6.2 å¹¶è¡Œè°ƒç”¨async/await</h3><p>åœ¨ä¸Šä¸€ä¸ªå‡½æ•°<code>doubleAndAdd</code>é‡Œä¾æ¬¡è°ƒç”¨äº†ä¸¤ä¸ª<code>async</code>å‡½æ•°ï¼Œä½†æ˜¯æ¯æ¬¡è°ƒç”¨éƒ½ç­‰å¾…äº†1ç§’ï¼Œæ•ˆç‡å¾ˆå·®ï¼›å› ä¸º<code>a</code>å’Œ<code>b</code>ä¹‹é—´æ²¡æœ‰è€¦åˆï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>Promise.all</code>æ¥å¹¶è¡Œæ‰§è¡Œè¿™ä¸¤æ¬¡è°ƒç”¨:</p><pre><code class="language-Javascript">async function doubleAndAdd(a, b) {
  // ä½¿ç”¨`Promise.all`
  // è¿™ä¸ªåœ°æ–¹ä½¿ç”¨æ•°ç»„`è§£æ„`
  // æ¥å¾—åˆ°ä¸¤æ¬¡è°ƒç”¨çš„ç»“æœ
  const [a, b] = Promise.all([doubleAfter1Sec(a), doubleAfter1Sec(b)])
  return a + b
}

doubleAndAdd(1, 2).then(console.log) // 5 

async function doubleAfter1Sec(param) {
  return new Promise(resolve =&gt; {
    setTimeout(() =&gt; {
      resolve(param * 2)
    }, 1000)
  })
}</code></pre><h3>6.3 async/awaitçš„é”™è¯¯å¤„ç†</h3><p>ä½¿ç”¨<code>async/await</code>æ—¶çš„é”™è¯¯å¤„ç†æœ‰å¾ˆå¤šæ–¹æ³•ï¼š</p><h4>1. åœ¨å‡½æ•°å†…ä½¿ç”¨try/catch</h4><pre><code class="language-Javascript">async function doubleAndAdd(a, b) {
  try {
    a = await doubleAfter1Sec(a)
    b = await doubleAfter1Sec(b)
  } catch (e) {
    return NaN
  }
  return a + b
}

doubleAndAdd(&#x27;one&#x27;, 2).then(console.log) // NaN
doubleAndAdd(1, 2).then(console.log) // 5 

async function doubleAfter1Sec(param) {
  return new Promise(resolve =&gt; {
    setTimeout(() =&gt; {
      const val = param * 2
      isNaN(val) ? reject(NaN) : resolve(val)
    }, 1000)
  })
}</code></pre><h4>2. catch æ‰€æœ‰<code>await</code>è¡¨è¾¾å¼</h4><p>å› ä¸º<code>await</code>è¡¨è¾¾å¼è¿”å›ä¸€ä¸ª<code>promise</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨<code>await</code>è¡¨è¾¾å¼åç›´æ¥æ‰§è¡Œ<code>catch</code>æ¥å¤„ç†é”™è¯¯</p><pre><code class="language-Javascript">async function doubleAndAdd(a, b) {
  a = await doubleAfter1Sec(a).catch(e =&gt; console.log(`&#x27;a&#x27; is NaN`)
  b = await doubleAfter1Sec(b).catch(e =&gt; console.log(`&#x27;b&#x27; is NaN`))

  if (!a || !b) return NaN
  return a + b
}

doubleAndAdd(&#x27;one&#x27;, 2).then(console.log) // NaN, &quot;a&quot; is NaN
doubleAndAdd(1, 2).then(console.log) // 5 

async function doubleAfter1Sec(param) {
  return new Promise(resolve =&gt; {
    setTimeout(() =&gt; {
      const val = param * 2
      isNaN(val) ? reject(NaN) : resolve(val)
    }, 1000)
  })
}</code></pre><h4>3. catch æ•´ä¸ªasync-awaitå‡½æ•°</h4><pre><code class="language-Javascript">async function doubleAndAdd(a, b) {
  a = await doubleAfter1Sec(a)
  b = await doubleAfter1Sec(b)
  return a + b
}

doubleAndAdd(&#x27;one&#x27;, 2)
  .then(console.log)
  .catch(console.log) // ä½¿ç”¨catch</code></pre><p><img style="display:block;margin:0 auto;margin-top:4rem;cursor:zoom-in" src="http://p6jqy6mfr.bkt.clouddn.com/1_X755b572fEcI0vK0fRKWkw.png"/></p><blockquote><p>ECMAScriptç›®å‰åœ¨æœ€ç»ˆç¨¿é˜¶æ®µï¼Œå°†ä¼šåœ¨2018å¹´6æœˆæˆ–7æœˆæ­£å¼æ¨å‡ºã€‚ä¸‹é¢ä»‹ç»çš„æ‰€æœ‰ç‰¹æ€§å±äº<strong>stage-4</strong>ï¼Œéƒ½å°†æˆä¸ºECMAScript 2018çš„ä¸€éƒ¨åˆ†ã€‚</p></blockquote><h2>1. å…±äº«å†…å­˜å’ŒåŸå­æ€§</h2><p>è¿™æ˜¯JSçš„ä¸€ä¸ªé«˜çº§ç‰¹æ€§ï¼Œæ˜¯JSå¼•æ“çš„æ ¸å¿ƒæ”¹è¿›ã€‚</p><p><strong>å…±äº«å†…å­˜çš„ä¸»è¦æ€æƒ³æ˜¯ï¼š æŠŠå¤šçº¿ç¨‹çš„ç‰¹æ€§å¸¦åˆ°JSï¼Œå¼€å‘è€…ä»ä¹‹å‰ç”±JSå¼•æ“ç®¡ç†å†…å­˜å˜ä¸ºè‡ªå·±ç®¡ç†å†…å­˜ï¼Œä»è€Œå†™å‡ºé«˜æ€§èƒ½ã€é«˜å¹¶å‘çš„ä»£ç ã€‚</strong></p><p>è¿™ä¸ªç‰¹æ€§ç”±ä¸€ä¸ªæ–°çš„å…¨å±€å¯¹è±¡<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/SharedArrayBuffer" target="_blank">SharedArrayBuffer</a>æ¥å®ç°ï¼Œè¿™ä¸ªå¯¹è±¡åœ¨ä¸€å—<strong>å…±äº«å†…å­˜ç©ºé—´</strong>å‚¨å­˜æ•°æ®ï¼Œè¿™éƒ¨åˆ†æ•°æ®å¯ä»¥ç”±JSçš„ä¸»çº¿ç¨‹å’Œ<code>web-worker</code>çº¿ç¨‹å…±äº«ã€‚</p><p>å½“å‰ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦åœ¨JSä¸»çº¿ç¨‹å’Œweb-workeré—´å…±äº«æ•°æ®æ—¶ï¼Œå¿…é¡»ä½¿ç”¨<code>postMessage</code>åœ¨ä¸åŒçº¿ç¨‹é—´ä¼ é€’æ•°æ®ï¼Œæœ‰äº†<code>SharedArrayBuffer</code>åï¼Œä¸åŒçš„çº¿ç¨‹å¯ä»¥ç›´æ¥è®¿é—®è¿™ä¸ªå¯¹è±¡æ¥å…±äº«æ•°æ®ã€‚</p><p>ä½†æ˜¯å¤šçº¿ç¨‹é—´çš„å…±äº«å†…å­˜ä¼šå¯¼è‡´ç«æ€æ¡ä»¶ï¼Œä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œå¼•å…¥äº†<code>åŸå­æ€§</code>çš„å…¨å±€å¯¹è±¡ã€‚åŸå­æ€§å¯¹è±¡æä¾›äº†å„ç§æ–¹æ³•æ¥é”ä½æ­£åœ¨è¢«æŸä¸ªçº¿ç¨‹è®¿é—®çš„å†…å­˜ï¼Œä»¥ä¿è¯å†…å­˜å®‰å…¨ã€‚</p></div></section><section class="post-footer"></section></article></div><div class="__react_component_tooltip place-top type-dark " data-id="tooltip"></div></div></div><script type="text/javascript">window.__CSS_CHUNKS__ = {"main":"https://shjie047.github.io/styles.49ed94a1.css"}</script><script type="text/javascript">
                window.__routeInfo = {'path':'post/2018-04-03/Here_are_examples_of_everything_new_in_ECMAScript_2016_2017_and_2018','templateID':2,'sharedPropsHashes':{},'localProps':null,'allProps':{'post':{'title':'ES2016, 2017\u548C2018\u5230\u5E95\u6709\u54EA\u4E9B\u65B0\u4E1C\u897F\uFF1F','author':'rajaraodv','tags':['js','JavaScript','\u524D\u7AEF','frontend','ECMAScript','ECMAScript 2016','ECMAScript 2017','ECMAScript 2018','es6','es7','async','await','async/await'],'iso8601Date':'2018-04-03T08:00:00+08:00','basename':'Here_are_examples_of_everything_new_in_ECMAScript_2016_2017_and_2018','body':'\n\n![](1_Z-9unq6Am3vekNOa5fD1xg.png)\n\nJavascript\u603B\u662F\u5728\u53D1\u5E03\u65B0\u529F\u80FD\uFF0C\u60F3\u8981\u4E00\u76F4\u8DDF\u4E0A\u811A\u6B65\u4E0D\u592A\u5BB9\u6613\uFF0C\u914D\u5957\u7684demo\u4E5F\u5F88\u5C11\uFF0C\u672C\u6587\u65E8\u5728\u7ED3\u5408\u5B9E\u4F8B\u5C55\u793A\u6700\u65B0\u768418\u4E2A\u65B0\u7279\u6027\uFF0C\u505A\u4E2A\u6280\u672F\u7684\u5E03\u9053\u8005\u3002\n\n**\u4E0B\u9762\u4F9D\u7167\u7248\u672C\u7684\u5148\u540E\u987A\u5E8F\u5F00\u59CB\u4ECB\u7ECD:**\n\n![](1_K09EWrqTcTwN9_dlhlzy6Q.png)\n\n## 1. Array.prototype.includes\n\n\u9996\u5148\u662F\u6570\u7EC4\u7684\u4E00\u4E2A\u5B9E\u4F8B\u65B9\u6CD5`includes`\uFF0C\u8FD9\u4E2A\u65B9\u6CD5\u7684\u529F\u80FD\u5F88\u7B80\u5355\uFF1A\u7528\u4E8E\u5224\u65AD\u67D0\u4E00\u9879\u662F\u5426\u5728\u6570\u7EC4\u91CC\uFF0C\u548C\u8FD9\u4E2A\u65B9\u6CD5\u529F\u80FD\u7C7B\u4F3C\u7684\u6709`indexOf`\uFF0C\u4E24\u8005\u7684\u533A\u522B\u662F`indexOf`\u65E0\u6CD5\u5224\u65AD`NaN`\uFF0C\n\u5982\u56FE\uFF1A\n\n```Javascript\nconst arr = [1, 2, 3, 4, NaN];\n\n// es5\nif (arr.indexOf(3) >= 0) {\n  console.log(true)\n}\n\n// es2016\nif (arr.includes(e)) {\n  console.log(true)\n}\n\n// \u6CE8\uFF1AindexOf\u4E0D\u652F\u6301\u68C0\u67E5`NaN`\narr.indexOf(NaN) // -1\narr.includes(NaN) // true\n```\n\n\n## 2. \u6C42\u5E42\u8FD0\u7B97\u7B26\n\n\u7B2C\u4E8C\u4E2A\u65B0\u529F\u80FD\u4E5F\u6BD4\u8F83\u7B80\u5355\uFF1A**\u6C42\u5E42\u8FD0\u7B97\u7B26** -- `**`\uFF0C\u7528\u4E8E\u53D6\u4EE3\u4E4B\u524D\u7684\u6C42\u5E42\u65B9\u6CD5`Math.pow`\uFF0C\n\u5982\u56FE\uFF1A\n\n```Javascript\n// \u4E4B\u524D\nMath.pow(3, 2) // 9\n\n// \u73B0\u5728\n3**2 // 9\n```\n\n![](1_fV_95TaY3ocgE8hlDhhv8w.png)\n\n## 1. Object.values()\n\n`Object.values`\u8FD9\u4E2A\u65B9\u6CD5\u548C`Object.keys`\u7C7B\u4F3C\uFF0C\u90FD\u662F\u8FD4\u56DE\u4E00\u4E2A\u6570\u7EC4\uFF0C\u901A\u8FC7\u65B9\u6CD5\u540D\u53EF\u4EE5\u76F4\u89C2\u7684\u731C\u5230\u8FD4\u56DE\u7684\u662F\u5BF9\u8C61\u7684\u503C(value)\uFF0C\u9700\u8981\u6CE8\u610F\u7684\u662F\uFF1A\u4E24\u4E2A\u65B9\u6CD5\u90FD\u662F\u8FD4\u56DE\u81EA\u8EAB\u539F\u578B\u7684\u5C5E\u6027\uFF0C\u4E0D\u5305\u62EC\u539F\u578B\u94FE\u4E0A\u7684\u5C5E\u6027\uFF0C\u5982\u56FE\uFF1A\n\n```Javascript\nconst cars = {BMW: 3, Tesla: 2, Toyota: 1}\n\n// es5\nconst vals = Object.keys(cars).map(key => cars[key]) \nconsole.log(vals) // [3, 2, 1]\n\n// es2016\nconst values = Object.values(cars)\nconsole.log(values) // [3, 2, 1]\n```\n\n\n## 2. Object.entries()\n\n`Object.entries()`\u8FD9\u4E2A\u65B9\u6CD5\u6BD4\u8F83\u6709\u610F\u601D\uFF0C\u6709\u70B9\u50CF`Object.keys`\u548C`Object.values`\u7684\u7ED3\u5408\u4F53\uFF0C\u540C\u65F6\u8FD4\u56DE\u5BF9\u8C61\u7684`key`\u548C`value`\uFF0C\u5E76\u5C01\u88C5\u5728\u4E00\u4E2A\u6570\u7EC4\u91CC\uFF0C\u8FD9\u4E2A\u65B9\u6CD5\u7684\u597D\u5904\u5728\u4E8E\u4F60\u53EF\u4EE5\u901A\u8FC7`for of`\u904D\u5386\u4E00\u6B21\u53D6\u51FAkey/value \u6216\u8005 \u628A`Object`\u8F6C\u4E3A`Map`\uFF1A\n\n**\u4F8B1**\uFF0C\u904D\u5386:\n\n```Javascript\nconst cars = { BMW: 3, Tesla: 2, Toyota: 1 }\n\n// es5\u7684\u904D\u5386\u65B9\u5F0F\n// \u9700\u8981\u628A`key`\u53D6\u51FA\u6765\uFF0C\u518D\u904D\u5386\nObject.keys(cars).forEach(key => {\n  console.log(`key: ${key}, value: ${cars[key]}`)\n})\n\n// es2017\nfor (let [key, value] of Object.entries(cars)) {\n  console.log(`key: ${key}, value: ${cars[key]}`)\n}\n``` \n\n**\u4F8B2**\uFF0C\u628Aobject\u76F4\u63A5\u8F6C\u6362\u4E3A`Map`:\n\n```Javascript\nconst cars = { BMW: 3, Tesla: 2, Toyota: 1 }\n\n// es5\nconst map1 = new Map()\nObject.keys(cars).map(key => {\n  map1.set(key, cars[key])\n})\n\nconsole.log(map1) // Map { \'BMW\': 3, \'Tesla\': 2, \'Toyota\': 1 }\n\n// es2016\nconst map2 = new Map(Object.entries(cars))\n\nconsole.log(map2) // Map { \'BMW\': 3, \'Tesla\': 2, \'Toyota\': 1 }\n```\n\n## 3. String padding\n\nString\u589E\u52A0\u4E86\u4E24\u4E2A\u5B9E\u4F8B\u65B9\u6CD5 -- `padStart`\u548C`padEnd`\uFF0C\u8FD9\u4E24\u4E2A\u65B9\u6CD5\u53EF\u4EE5\u5728\u5B57\u7B26\u4E32\u7684\u9996/\u5C3E\u6DFB\u52A0\u5176\u4ED6\u5B57\u7B26\u4E32:\n\n```Javascript\n// \'someStr\'.padStart(\u5B57\u7B26\u6570, [,\u6DFB\u52A0\u7684\u5B57\u7B26])\n\n\'hello\'.padStart(\'10\', \'a\') // \'aaaaahello\', \u6DFB\u52A0\u4E865\u4E2A\u5B57\u7B26`a`\u540E\u4E00\u5171`10`\u4E2A\u5B57\u7B26\n\'hello\'.padEnd(\'10\', \'b\') // \'hellobbbbb\'\n\'hello\'.padStart(\'7\') // \'  hello\', \u5728\u5934\u90E8\u6DFB\u52A0\u4E24\u4E2A\u4E2A\u7A7A\u683C\n```\n\n### 3.1 padStart\u793A\u4F8B\n\n```Javascript\nconst formatted = [0, 1, 12, 123, 1234, 12345].map(num =>\n  num.toString().padStart(10, \'0\')\n)\n\nconsole.log(formatted)\n// \u8F93\u51FA:\n// [\n//   \'0000000000\',\n//   \'0000000001\',\n//   \'0000000012,\'\n//   \'0000000234,\'\n//   \'0000001234,\'\n//   \'0009012345\'\n// ]\n```\n\n### 3.2 padEnd\u793A\u4F8B\n\n```Javascript\nconst cars = {\n  \'\uD83D\uDE99BMW\': \'10\',\n  \'\uD83D\uDE98Tesla\': \'5\',\n  \'\uD83D\uDE96Lamborghini\': \'0\'\n}\n\nObject.entries(cars).map(([name, count]) => {\n  console.log(`${name.padEnd(20, \' -\')} Count: ${count.padStart(3, \'0\')}`)\n});\n\n//\u8F93\u51FA:\n// \uD83D\uDE99BMW - - - - - - -  Count: 010\n// \uD83D\uDE98Tesla - - - - - -  Count: 005\n// \uD83D\uDE96Lamborghini - - -  Count: 000\n```\n\n## 4.Object.getOwnPropertyDescriptors\n\n\u8FD9\u4E2A\u65B9\u6CD5\u7684\u4F5C\u7528\u662F\u8865\u5145`Object.assign`\u7684\u529F\u80FD\uFF0C\u5728\u6D45\u62F7\u8D1D(shallow clone)\u5BF9\u8C61\u7684\u57FA\u7840\u4E0A\uFF0C\u4E5F\u4F1A\u590D\u5236`getter`\u548C`setter`\u65B9\u6CD5\uFF1A\n\n\u4E0B\u9762\u7684\u4F8B\u5B50\u7528`Object.defineProperties`\u62F7\u8D1D\u539F\u5BF9\u8C61`Car`\u5230\u65B0\u5BF9\u8C61`ElectricCar`\u6765\u533A\u5206`Object.assign`\u548C`Object.getOwnPropertyDescriptors`\u3002\n\n```Javascript\nconst Car = {\n  name: \'BMW\',\n  price: 100000,\n  set discount(x) {\n    this.d = x\n  }\n  get discount() {\n    return this.d\n  }\n}\n\nconsole.log(Object.getOwnPropertyDescriptor(Car, \'discount\')\n// \u8F93\u51FA:\n// {\n//   get: [Function: get],\n//   set: [Function: set],\n//   enumerable: true,\n//   configurable: true\n// }\n\nconst ElectricCar = Object.assign({}, Car)\nconsole.log(Object.getOwnPropertyDescriptor(ElectricCar, \'discount\'))\n// \u8F93\u51FA:\n// {\n//   value: undefined,\n//   writable: true,\n//   enumerable: true,\n//   configurable: true\n// }\n\n// \u4F7F\u7528`Object.assign`\u521B\u5EFA`ElectricCar`\u540E\uFF0C\u5C5E\u6027`getter`\u548C`setter`\u4E22\u5931\u4E86\n```\n\n### \u4F7F\u7528`Object.getOwnPropertyDescriptors`\u540E:\n\n```Javascript\nconst Car = {\n  name: \'BMW\',\n  price: 100000,\n  set discount(x) {\n    this.d = x\n  }\n  get discount() {\n    return this.d\n  }\n}\n\nconst ElectricCar2 = Object.defineProperties({}, Object.getOwnPropertyDescriptors(Car))\n// \u8F93\u51FA:\n// {\n//   get: [Function: get],  <-----\uD83D\uDC48\n//   set: [Function: set],  <-----\uD83D\uDC48\n//   enumerable: true,\n//   configurable: true \n// }\n```\n\n## 5. \u5728\u51FD\u6570\u6700\u540E\u4E00\u4E2A\u53C2\u6570\u7684\u672B\u5C3E\u6DFB\u52A0\u9017\u53F7\n\n\u8FD9\u662F\u4E2A\u5F88\u5C0F\u7684\u4E00\u4E2A\u529F\u80FD\u70B9\uFF0C\u5728\u51FD\u6570\u5F62\u53C2\u6700\u540E\u4E00\u4E2A\u53C2\u6570\u672B\u5C3E\u6DFB\u52A0\u9017\u53F7\uFF0C\u53EF\u4EE5\u907F\u514D`git blame`\u63D0\u793A\u4E0D\u5FC5\u8981\u7684\u6539\u52A8\uFF0C\n\u4EE3\u7801\u793A\u4F8B\uFF1A\n\n```Javascript\n// \u5047\u8BBE\u8FD9\u4E2A\u51FD\u6570\u7531 `\u7A0B\u5E8F\u5458_1` \u521B\u5EFA\n// \u8FD9\u4E2A\u51FD\u6570\u6700\u540E\u4E00\u4E2A\u53C2\u6570`age`\u540E\u6CA1\u6709\u9017\u53F7\nfunction Person(\n  name,\n  age\n) {\n  this.name = name\n  this.age = age\n}\n\n// \u5982\u679C `\u7A0B\u5E8F\u5458_2` \u8FD9\u65F6\u6709\u4E86\u4EE5\u4E0B\u4FEE\u6539\nfunction Person(\n  name,\n  age, /* \u90A3\u4E48\u8FD9\u4E2A`,`\u9017\u53F7\u4E5F\u4F1A\u5F15\u8D77`git blame`\u8BA4\u4E3A `\u7A0B\u5E8F\u5458_1` \u4FEE\u6539\u4E86\u8FD9\u4E00\u884C*/\n  gender /* \u6DFB\u52A0\u4E86\u65B0\u53C2\u6570 */\n) { // \u65B0\u6DFB\u52A0\n  this.name = name\n  this.age = age\n  this.gender = gender // \u65B0\u6DFB\u52A0\n}\n\n// es2017\u5BF9\u8FD9\u4E2A\u6DF7\u6DC6\u7684\u5904\u7406\u529E\u6CD5\u662F:\n// \u901A\u8FC7 `\u7A0B\u5E8F\u5458_1`\u5728`age`\u672B\u5C3E\u6DFB\u52A0`,`\u9017\u53F7\n\n// \u66F4\u65B0\u5982\u4E0B:\n\n// \u5047\u8BBE\u8FD9\u4E2A\u51FD\u6570\u7531 `\u7A0B\u5E8F\u5458_1` \u521B\u5EFA\n// \u5728\u6700\u540E\u4E00\u4E2A\u53C2\u6570`age`\u540E\u6DFB\u52A0`,`\u9017\u53F7\nfunction Person(\n  name,\n  age, /* \u6DFB\u52A0\u9017\u53F7 */\n) {\n  this.name = name\n  this.age = age\n}\n```\n\n## 6. Async/Await\n\n\u8FD9\u4E2A\u7279\u6027\u662F\u76EE\u524D\u4E3A\u6B62\u6700\u91CD\u8981\u7684\u4E00\u4E2A\u529F\u80FD\uFF0C\u4F7F\u7528`async`\u51FD\u6570\u53EF\u4EE5\u8BA9\u6211\u4EEC\u907F\u514D\u9891\u7E41\u8C03\u7528*\u6076\u5FC3\u7684*`callback`\uFF0C\u4F7F\u4EE3\u7801\u4FDD\u6301\u5E72\u51C0\u6574\u6D01\u3002\n\n\u5F53\u7F16\u8BD1\u5668\u8FDB\u5165`async`\u51FD\u6570\u540E\uFF0C\u9047\u5230`await`\u5173\u952E\u5B57\u4F1A\u6682\u505C\u6267\u884C\uFF0C\u53EF\u4EE5\u628A`await`\u540E\u7684\u8868\u8FBE\u5F0F\u770B\u6210\u4E00\u4E2A`promise`\uFF0C\u76F4\u5230promise\u88AB`resolve`\u6216`reject`\u540E\uFF0C\u51FD\u6570\u624D\u4F1A\u6062\u590D\u6267\u884C\uFF0C\n\u5177\u4F53\u770B\u5982\u4E0B\u4EE3\u7801\uFF1A\n\n```Javascript\n  \n// es5\u7684`Promise`\nfunction getAmount(userId) {\n  getUser(userId)\n    .then(getBankBalance)\n    .then(amount => {\n      console.log(amount)\n    })\n}\n\n// es2017\u7684`async`\nasync function getAmount2(userId) {\n  var user = await getUser(userId)\n  var amount = await getBankBalance()\n  console.log(amount)\n}\n\ngetAmount(\'1\') // $1,000\ngetAmount2(\'1\') // $1,000\n\nfunction getUser(userId) {\n  return new Promise(resolve => {\n    setTimeout(() => {\n      resolve(\'\u5F20\u4E09\')\n    }, 1000)\n  })\n}\n\nfunction getBankBalance() {\n  return new Promise((resolve, reject) => {\n    setTimeout(() => {\n      if (user === \'\u5F20\u4E09\') {\n        resolve(\'$1,000\')\n      } else {\n        resolve(\'Unknown User\')\n      }\n    }, 1000)\n  })\n}\n```\n\n### 6.1 Async\u51FD\u6570\u672C\u8EAB\u8FD4\u56DE\u4E00\u4E2APromise\n\n\u8981\u60F3\u5F97\u5230Async\u51FD\u6570\u7684\u8FD4\u56DE\u503C\uFF0C\u9700\u8981\u628A\u8FD4\u56DE\u503C\u5F53\u4F5C\u4E00\u4E2Apromise\u8FDB\u884C`then`\u6C42\u503C\u3002\n\n\u5177\u4F53\u770B\u5982\u4E0B\u4EE3\u7801\uFF1A\n\n```Javascript\nasync function doubleAndAdd(a, b) {\n  a = await doubleAfter1Sec(a)\n  b = await doubleAfter1Sec(b)\n  return a + b\n}\n\ndoubleAndAdd(1, 2).then(console.log) // 5 \n\nasync function doubleAfter1Sec(param) {\n  return new Promise(resolve => {\n    setTimeout(() => {\n      resolve(param * 2)\n    }, 1000)\n  })\n}\n```\n\n### 6.2 \u5E76\u884C\u8C03\u7528async/await\n\n\u5728\u4E0A\u4E00\u4E2A\u51FD\u6570`doubleAndAdd`\u91CC\u4F9D\u6B21\u8C03\u7528\u4E86\u4E24\u4E2A`async`\u51FD\u6570\uFF0C\u4F46\u662F\u6BCF\u6B21\u8C03\u7528\u90FD\u7B49\u5F85\u4E861\u79D2\uFF0C\u6548\u7387\u5F88\u5DEE\uFF1B\u56E0\u4E3A`a`\u548C`b`\u4E4B\u95F4\u6CA1\u6709\u8026\u5408\uFF0C\u6240\u4EE5\u6211\u4EEC\u53EF\u4EE5\u4F7F\u7528`Promise.all`\u6765\u5E76\u884C\u6267\u884C\u8FD9\u4E24\u6B21\u8C03\u7528:\n\n```Javascript\nasync function doubleAndAdd(a, b) {\n  // \u4F7F\u7528`Promise.all`\n  // \u8FD9\u4E2A\u5730\u65B9\u4F7F\u7528\u6570\u7EC4`\u89E3\u6784`\n  // \u6765\u5F97\u5230\u4E24\u6B21\u8C03\u7528\u7684\u7ED3\u679C\n  const [a, b] = Promise.all([doubleAfter1Sec(a), doubleAfter1Sec(b)])\n  return a + b\n}\n\ndoubleAndAdd(1, 2).then(console.log) // 5 \n\nasync function doubleAfter1Sec(param) {\n  return new Promise(resolve => {\n    setTimeout(() => {\n      resolve(param * 2)\n    }, 1000)\n  })\n}\n```\n\n### 6.3 async/await\u7684\u9519\u8BEF\u5904\u7406\n\n\u4F7F\u7528`async/await`\u65F6\u7684\u9519\u8BEF\u5904\u7406\u6709\u5F88\u591A\u65B9\u6CD5\uFF1A\n\n#### 1. \u5728\u51FD\u6570\u5185\u4F7F\u7528try/catch\n\n```Javascript\nasync function doubleAndAdd(a, b) {\n  try {\n    a = await doubleAfter1Sec(a)\n    b = await doubleAfter1Sec(b)\n  } catch (e) {\n    return NaN\n  }\n  return a + b\n}\n\ndoubleAndAdd(\'one\', 2).then(console.log) // NaN\ndoubleAndAdd(1, 2).then(console.log) // 5 \n\nasync function doubleAfter1Sec(param) {\n  return new Promise(resolve => {\n    setTimeout(() => {\n      const val = param * 2\n      isNaN(val) ? reject(NaN) : resolve(val)\n    }, 1000)\n  })\n}\n```\n\n#### 2. catch \u6240\u6709`await`\u8868\u8FBE\u5F0F\n\n\u56E0\u4E3A`await`\u8868\u8FBE\u5F0F\u8FD4\u56DE\u4E00\u4E2A`promise`\uFF0C\u6240\u4EE5\u6211\u4EEC\u53EF\u4EE5\u5728`await`\u8868\u8FBE\u5F0F\u540E\u76F4\u63A5\u6267\u884C`catch`\u6765\u5904\u7406\u9519\u8BEF\n\n```Javascript\nasync function doubleAndAdd(a, b) {\n  a = await doubleAfter1Sec(a).catch(e => console.log(`\'a\' is NaN`)\n  b = await doubleAfter1Sec(b).catch(e => console.log(`\'b\' is NaN`))\n\n  if (!a || !b) return NaN\n  return a + b\n}\n\ndoubleAndAdd(\'one\', 2).then(console.log) // NaN, "a" is NaN\ndoubleAndAdd(1, 2).then(console.log) // 5 \n\nasync function doubleAfter1Sec(param) {\n  return new Promise(resolve => {\n    setTimeout(() => {\n      const val = param * 2\n      isNaN(val) ? reject(NaN) : resolve(val)\n    }, 1000)\n  })\n}\n```\n\n#### 3. catch \u6574\u4E2Aasync-await\u51FD\u6570\n\n```Javascript\nasync function doubleAndAdd(a, b) {\n  a = await doubleAfter1Sec(a)\n  b = await doubleAfter1Sec(b)\n  return a + b\n}\n\ndoubleAndAdd(\'one\', 2)\n  .then(console.log)\n  .catch(console.log) // \u4F7F\u7528catch\n```\n\n![](1_X755b572fEcI0vK0fRKWkw.png)\n\n> ECMAScript\u76EE\u524D\u5728\u6700\u7EC8\u7A3F\u9636\u6BB5\uFF0C\u5C06\u4F1A\u57282018\u5E746\u6708\u62167\u6708\u6B63\u5F0F\u63A8\u51FA\u3002\u4E0B\u9762\u4ECB\u7ECD\u7684\u6240\u6709\u7279\u6027\u5C5E\u4E8E**stage-4**\uFF0C\u90FD\u5C06\u6210\u4E3AECMAScript 2018\u7684\u4E00\u90E8\u5206\u3002\n\n## 1. \u5171\u4EAB\u5185\u5B58\u548C\u539F\u5B50\u6027\n\n\u8FD9\u662FJS\u7684\u4E00\u4E2A\u9AD8\u7EA7\u7279\u6027\uFF0C\u662FJS\u5F15\u64CE\u7684\u6838\u5FC3\u6539\u8FDB\u3002\n\n**\u5171\u4EAB\u5185\u5B58\u7684\u4E3B\u8981\u601D\u60F3\u662F\uFF1A \u628A\u591A\u7EBF\u7A0B\u7684\u7279\u6027\u5E26\u5230JS\uFF0C\u5F00\u53D1\u8005\u4ECE\u4E4B\u524D\u7531JS\u5F15\u64CE\u7BA1\u7406\u5185\u5B58\u53D8\u4E3A\u81EA\u5DF1\u7BA1\u7406\u5185\u5B58\uFF0C\u4ECE\u800C\u5199\u51FA\u9AD8\u6027\u80FD\u3001\u9AD8\u5E76\u53D1\u7684\u4EE3\u7801\u3002**\n\n\u8FD9\u4E2A\u7279\u6027\u7531\u4E00\u4E2A\u65B0\u7684\u5168\u5C40\u5BF9\u8C61[SharedArrayBuffer](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/SharedArrayBuffer)\u6765\u5B9E\u73B0\uFF0C\u8FD9\u4E2A\u5BF9\u8C61\u5728\u4E00\u5757**\u5171\u4EAB\u5185\u5B58\u7A7A\u95F4**\u50A8\u5B58\u6570\u636E\uFF0C\u8FD9\u90E8\u5206\u6570\u636E\u53EF\u4EE5\u7531JS\u7684\u4E3B\u7EBF\u7A0B\u548C`web-worker`\u7EBF\u7A0B\u5171\u4EAB\u3002\n\n\u5F53\u524D\uFF0C\u5982\u679C\u6211\u4EEC\u60F3\u8981\u5728JS\u4E3B\u7EBF\u7A0B\u548Cweb-worker\u95F4\u5171\u4EAB\u6570\u636E\u65F6\uFF0C\u5FC5\u987B\u4F7F\u7528`postMessage`\u5728\u4E0D\u540C\u7EBF\u7A0B\u95F4\u4F20\u9012\u6570\u636E\uFF0C\u6709\u4E86`SharedArrayBuffer`\u540E\uFF0C\u4E0D\u540C\u7684\u7EBF\u7A0B\u53EF\u4EE5\u76F4\u63A5\u8BBF\u95EE\u8FD9\u4E2A\u5BF9\u8C61\u6765\u5171\u4EAB\u6570\u636E\u3002\n\n\u4F46\u662F\u591A\u7EBF\u7A0B\u95F4\u7684\u5171\u4EAB\u5185\u5B58\u4F1A\u5BFC\u81F4\u7ADE\u6001\u6761\u4EF6\uFF0C\u4E3A\u4E86\u907F\u514D\u8FD9\u79CD\u60C5\u51B5\uFF0C\u5F15\u5165\u4E86`\u539F\u5B50\u6027`\u7684\u5168\u5C40\u5BF9\u8C61\u3002\u539F\u5B50\u6027\u5BF9\u8C61\u63D0\u4F9B\u4E86\u5404\u79CD\u65B9\u6CD5\u6765\u9501\u4F4F\u6B63\u5728\u88AB\u67D0\u4E2A\u7EBF\u7A0B\u8BBF\u95EE\u7684\u5185\u5B58\uFF0C\u4EE5\u4FDD\u8BC1\u5185\u5B58\u5B89\u5168\u3002\n','date':'2018-04-03'}},'siteData':{'title':'React Static'}};</script><script defer="" type="text/javascript" src="https://shjie047.github.io/bootstrap.9d1d5f8f.js"></script><script defer="" type="text/javascript" src="https://shjie047.github.io/templates/src/containers/Post.f97300b9.js"></script><script defer="" type="text/javascript" src="https://shjie047.github.io/main.96794c51.js"></script></body></html>